<%= javascript_include_tag 'hidden_fields.js' -%>
<% if controller.action_name == "search" -%>
<div class="left normal-padding-left normal-padding-top normal-padding-bottom normal-padding-right normal-margin-bottom" id="advanced_search_checkboxes" style="border-radius: 6px; -moz-border-radius: 6px; -webkit-border-radius: 6px; border: 2px solid lightgray;">
<div class="normal-padding-bottom">
<ul style="margin: 0; display: inline-block;">
<li class="larger-font"><%= check_box_tag 'search_type[]', 'variables', true, :onclick=>"setHiddenFieldValue('variable_select');" -%>Variables</li>
<%= javascript_tag "storeHiddenFieldValue('variable_select', true)"-%>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'variable_name', true, :onclick=>"setHiddenFieldValue('variable_name');" -%>name</li>
<%= javascript_tag "storeHiddenFieldValue('variable_name', true)"-%>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'variable_description', true, :onclick=>"setHiddenFieldValue('variable_description');" -%>description</li>
<%= javascript_tag "storeHiddenFieldValue('variable_description', true)"-%>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'variable_value', true -%>values</li>
<%= javascript_tag "storeHiddenFieldValue('variable_value', true)"-%>
</ul>
</div>
<div class="normal-padding-bottom">
<ul style="margin: 0; display: inline-block;">
<li class="larger-font"><%= check_box_tag 'search_type[]', 'surveys', true -%><%= SURVEY.pluralize -%></li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'survey_title', true -%>title</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'survey_description', true -%>description</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'survey_location', true -%>location</li>
<li><%= select_tag 'survey_location' ,options_for_select(location_search_options, :selected=>"ANY") -%></li>
</ul>
</div>
<div class="normal-padding-bottom">
<ul style="margin: 0; display: inline-block;">
<li class="larger-font"><%= check_box_tag 'search_type[]', 'methods', true -%>Methods</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'dataset_title', true -%>title</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'dataset_description', true -%>description</li>
</ul>
</div>
<div class="normal-padding-bottom">
<ul style="margin: 0; display: inline-block;">
<li class="larger-font"><%= check_box_tag 'search_type[]', 'datasets', true -%><%= DATASET.pluralize -%></li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'dataset_title', true -%>title</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'dataset_description', true -%>description</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'dataset_year', true -%>year</li>
<% start_year = Dataset.scoped(:select => "DISTINCT year").sort!{|x,y| x.year.to_i <=> y.year.to_i}.delete_if{|x| x.year == nil}.first.year.to_i -%>
<li class="small-padding-top small-padding-bottom"><%= select_year(start_year, :start_year => start_year, :end_year => Date.today.year) -%> to <%= select_year(Date.today, :start_year => start_year, :end_year => Date.today.year) -%><li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'dataset_location', true -%>location</li>
<li><%= select_tag 'dataset_location' ,options_for_select(location_search_options, :selected=>"ANY") -%></li>
</ul>
</div>
<div class="normal-padding-bottom">
<ul style="margin: 0; display: inline-block;">
<li class="larger-font"><%= check_box_tag 'search_type[]', 'extracts', true -%>Data Extracts</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'extract_title', true -%>title</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'extract_description', true -%>description</li>
</ul>
</div>
<div class="normal-padding-bottom">
<ul style="margin: 0; display: inline-block;">
<li class="larger-font"><%= check_box_tag 'search_type[]', 'publications', true -%>Publications</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'publication_title', true -%>title</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'publication_description', true -%>description</li>
</ul>
</div>
<div class="normal-padding-bottom">
<ul style="margin: 0; display: inline-block;">
<li class="larger-font"><%= check_box_tag 'search_type[]', 'people', true -%>People</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'people_name', true -%>name</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'people_description', true -%>description</li>
<li class="medium-padding-left"><%= check_box_tag 'search_type[]', 'people_expertise', true -%>expertise</li>
</ul>
</div>
</div>
<% end -%>
<div class="middle-padding medium-padding-top">
<div class="center"><%= link_to image_tag("box_transparent_medium.png",:alt=>"www.methodbox.org",:title=>"Search and download variables from ESDS and other providers."),root_path -%></div>
<% form_tag('/search/', :method=>"get") do -%>
<!-- search for everything from the main page -->
<!-- initial search is for first page -->
<div id="hidden_fields">
<%= hidden_field_tag 'person_page', 1 -%>
<%= hidden_field_tag 'survey_page', 1 -%>
<%= hidden_field_tag 'script_page', 1 -%>
<%= hidden_field_tag 'csvarchive_page', 1 -%>
<%= hidden_field_tag 'publication_page', 1 -%>
<%= hidden_field_tag 'variable_page', 1 -%>
<%= hidden_field_tag 'advanced_search', true -%>
<%= hidden_field_tag 'variable_select', true -%>
<%= hidden_field_tag 'variable_name', true -%>
<%= hidden_field_tag 'variable_description'-%>
<%= hidden_field_tag 'variable_value', true -%>
<%= hidden_field_tag 'survey_select', true -%>
<%= hidden_field_tag 'survey_title', true -%>
<%= hidden_field_tag 'survey_description', true -%>
<%= hidden_field_tag 'dataset_select', true -%>
<%= hidden_field_tag 'dataset_title', true -%>
<%= hidden_field_tag 'dataset_description', true -%>
<%= hidden_field_tag 'script_select', true -%>
<%= hidden_field_tag 'script_title', true -%>
<%= hidden_field_tag 'script_description', true -%>
<%= hidden_field_tag 'extract_select', true -%>
<%= hidden_field_tag 'extract_title', true -%>
<%= hidden_field_tag 'extract_description', true -%>
<%= hidden_field_tag 'publication_select', true -%>
<%= hidden_field_tag 'publication_title', true-%>
<%= hidden_field_tag 'publication_description', true -%>
<%= hidden_field_tag 'people_select', true -%>
<%= hidden_field_tag 'person_name', true -%>
<%= hidden_field_tag 'person_description', true -%>
<%= hidden_field_tag 'person_expertise', true -%>
</div>
<div class="center normal-padding-bottom">
<%= text_field_tag :search_query, @search_query, :style=>"width: 100%; height: 25px;font: 17px arial,sans-serif;", :title=>'Find variables, ' + SURVEY.pluralize + ', people, methods and more . Use + for terms that must be included, - for terms to be excluded & double quotes around phrases eg. +private "health insurance" -covered' -%>
</div>
<div class="center normal-padding-bottom" id="advanced-search-options" style="<%= @advanced_controls ? '' : 'display:none'-%>">
<div>
<table>
<tbody>
<tr><td style="font-size: smaller; color: #484848;">Select the things you want to search.  Maybe you want to find variables from a <%= SURVEY.downcase -%> with a particular name, perhaps you need to find a <%= DATASET.downcase -%> from a certain year. Exclude and/or include resource types and search fields using the options in the sidebar.</td></tr>
<tr><td style="font-size: smaller; color: #484848;">Use + for terms that must be included, - for terms to be excluded & double quotes around phrases eg. +private "health insurance" -covered</td></tr>
</tbody>
</table>
</div>
</div>
<div style="text-align: center;">
<%= submit_tag "Search", :id=>"search_button", :style=>"width: 80px; height: 25px;font: 17px arial,sans-serif;", :title=>"Find what you are looking for......", :onclick => "if (!checkNotEmpty('search_query')) {return false;} else {Element.show('spinner');$('search_button').form.submit();return true;}"   -%>
</div>
<% end  -%>
</div>
