<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Module: Annotations::Acts::Annotatable::InstanceMethods</title>

	<link rel="stylesheet" href="../../../rdoc.css" type="text/css" media="screen" />

	<script src="../../../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="module">

	<div id="metadata">
		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../../../lib/annotations/acts_as_annotatable_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/annotations/acts_as_annotatable.rb">lib/annotations/acts_as_annotatable.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#M000018">#all_annotations_excluding_attributes</a></li>
					
					<li><a href="#M000013">#annotatable_name</a></li>
					
					<li><a href="#M000015">#annotations_with_attribute</a></li>
					
					<li><a href="#M000017">#annotations_with_attribute_and_by_source</a></li>
					
					<li><a href="#M000016">#annotations_with_attributes</a></li>
					
					<li><a href="#M000020">#count_annotations_by</a></li>
					
					<li><a href="#M000021">#create_annotations</a></li>
					
					<li><a href="#M000014">#latest_annotations</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="../../../AUTHORS_rdoc.html">AUTHORS.rdoc</a></li>
				
					<li class="file"><a href="../../../CHANGELOG_rdoc.html">CHANGELOG.rdoc</a></li>
				
					<li class="file"><a href="../../../INDEX_rdoc.html">INDEX.rdoc</a></li>
				
					<li class="file"><a href="../../../LICENSE.html">LICENSE</a></li>
				
					<li class="file"><a href="../../../README_rdoc.html">README.rdoc</a></li>
				
					<li class="file"><a href="../../../RUNNING_TESTS_rdoc.html">RUNNING_TESTS.rdoc</a></li>
				
					<li class="file"><a href="../../../RakeFile.html">RakeFile</a></li>
				
					<li class="file"><a href="../../../TODO_rdoc.html">TODO.rdoc</a></li>
				
					<li class="file"><a href="../../../VERSION_yml.html">VERSION.yml</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../../../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../../../Annotations/Acts/Annotatable/ClassMethods.html">Annotations::Acts::Annotatable::ClassMethods</a></li>
				
					<li><a href="../../../Annotations/Acts/Annotatable/InstanceMethods.html">Annotations::Acts::Annotatable::InstanceMethods</a></li>
				
					<li><a href="../../../Annotations/Acts/Annotatable/SingletonMethods.html">Annotations::Acts::Annotatable::SingletonMethods</a></li>
				
					<li><a href="../../../Annotations/Acts/AnnotationSource/ClassMethods.html">Annotations::Acts::AnnotationSource::ClassMethods</a></li>
				
					<li><a href="../../../Annotations/Acts/AnnotationSource/InstanceMethods.html">Annotations::Acts::AnnotationSource::InstanceMethods</a></li>
				
					<li><a href="../../../Annotations/Acts/AnnotationSource/SingletonMethods.html">Annotations::Acts::AnnotationSource::SingletonMethods</a></li>
				
					<li><a href="../../../Annotations/Config.html">Annotations::Config</a></li>
				
					<li><a href="../../../AnnotationsVersionFu.html">AnnotationsVersionFu</a></li>
				
					<li><a href="../../../AnnotationsVersionFu/ClassMethods.html">AnnotationsVersionFu::ClassMethods</a></li>
				
					<li><a href="../../../AnnotationsVersionFu/InstanceMethods.html">AnnotationsVersionFu::InstanceMethods</a></li>
				
					<li><a href="../../../Annotation.html">Annotation</a></li>
				
					<li><a href="../../../AnnotationAttribute.html">AnnotationAttribute</a></li>
				
					<li><a href="../../../AnnotationValueSeed.html">AnnotationValueSeed</a></li>
				
					<li><a href="../../../AnnotationsController.html">AnnotationsController</a></li>
				
					<li><a href="../../../AnnotationsMigrationGenerator.html">AnnotationsMigrationGenerator</a></li>
				
					<li><a href="../../../AnnotationsMigrationV1.html">AnnotationsMigrationV1</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="module">Annotations::Acts::Annotatable::InstanceMethods</h1>

		<div id="description">
			<p>
This module contains instance methods
</p>

		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="all-annotations-excluding-attributes-method" class="method-detail ">
				<a name="M000018"></a>

				<div class="method-heading">
				
					<span class="method-name">all_annotations_excluding_attributes</span><span
						class="method-args">(attribs)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Finder to get all annotations on this object excluding those that have the
attribute names specified.
</p>
<p>
NOTE (1): the argument to this method MUST be an Array of Strings. NOTE
(2): the returned records will be Read Only.
</p>
					

					
					<div class="method-source-code"
						id="all-annotations-excluding-attributes-source">
<pre>
     <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 146</span>
146:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_annotations_excluding_attributes</span>(<span class="ruby-identifier">attribs</span>)
147:           <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attribs</span>.<span class="ruby-identifier">blank?</span>
148:           
149:           <span class="ruby-identifier">obj_type</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:class_name_of_active_record_descendant</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>).<span class="ruby-identifier">to_s</span>
150:           
151:           <span class="ruby-constant">Annotation</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,
152:                           <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:attribute</span>,
153:                           <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-value str">&quot;`annotations`.`annotatable_type` = ? AND `annotations`.`annotatable_id` = ? AND `annotation_attributes`.`name` NOT IN (?)&quot;</span>,
154:                                            <span class="ruby-identifier">obj_type</span>,
155:                                            <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span>,
156:                                            <span class="ruby-identifier">attribs</span> ],
157:                           <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;`annotations`.`created_at` DESC&quot;</span>)
158:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="annotatable-name-method" class="method-detail ">
				<a name="M000013"></a>

				<div class="method-heading">
				
					<span class="method-name">annotatable_name</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Provides a default implementation to get the display name for an
annotatable object, that can be overrided.
</p>
					

					
					<div class="method-source-code"
						id="annotatable-name-source">
<pre>
    <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 71</span>
71:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">annotatable_name</span>
72:           <span class="ruby-node">%w{ display_name title name }</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">w</span><span class="ruby-operator">|</span>
73:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">eval</span>(<span class="ruby-node">&quot;self.#{w}&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">w</span>)
74:           <span class="ruby-keyword kw">end</span>
75:           <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{self.class.name}_#{id}&quot;</span>
76:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="annotations-with-attribute-method" class="method-detail ">
				<a name="M000015"></a>

				<div class="method-heading">
				
					<span class="method-name">annotations_with_attribute</span><span
						class="method-args">(attrib)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Finder to get annotations with a specific attribute. The input parameter is
the attribute name (MUST be a String representing the attribute&#8217;s
name).
</p>
					

					
					<div class="method-source-code"
						id="annotations-with-attribute-source">
<pre>
     <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 92</span>
 92:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">annotations_with_attribute</span>(<span class="ruby-identifier">attrib</span>)
 93:           <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">blank?</span>
 94:           
 95:           <span class="ruby-identifier">obj_type</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:class_name_of_active_record_descendant</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>).<span class="ruby-identifier">to_s</span>
 96:           
 97:           <span class="ruby-constant">Annotation</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,
 98:                           <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:attribute</span>,
 99:                           <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:annotatable_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">obj_type</span>,
100:                                            <span class="ruby-identifier">:annotatable_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span>,
101:                                            <span class="ruby-identifier">:annotation_attributes</span> =<span class="ruby-operator">&gt;</span>  { <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span> } },
102:                           <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;created_at DESC&quot;</span>)
103:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="annotations-with-attribute-and-by-source-method" class="method-detail ">
				<a name="M000017"></a>

				<div class="method-heading">
				
					<span class="method-name">annotations_with_attribute_and_by_source</span><span
						class="method-args">(attrib, source)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Finder to get annotations with a specific attribute by a specific source.
</p>
<p>
The first input parameter is the attribute name (MUST be a String
representing the attribute&#8217;s name). The second input is the source
object.
</p>
					

					
					<div class="method-source-code"
						id="annotations-with-attribute-and-by-source-source">
<pre>
     <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 126</span>
126:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">annotations_with_attribute_and_by_source</span>(<span class="ruby-identifier">attrib</span>, <span class="ruby-identifier">source</span>)
127:           <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">nil?</span>
128:           
129:           <span class="ruby-identifier">obj_type</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:class_name_of_active_record_descendant</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>).<span class="ruby-identifier">to_s</span>
130:           
131:           <span class="ruby-constant">Annotation</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,
132:                           <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:attribute</span>,
133:                           <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:annotatable_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">obj_type</span>,
134:                                            <span class="ruby-identifier">:annotatable_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span>,
135:                                            <span class="ruby-identifier">:source_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>,
136:                                            <span class="ruby-identifier">:source_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">id</span>,
137:                                            <span class="ruby-identifier">:annotation_attributes</span> =<span class="ruby-operator">&gt;</span>  { <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attrib</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span> } },
138:                           <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;created_at DESC&quot;</span>)
139:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="annotations-with-attributes-method" class="method-detail ">
				<a name="M000016"></a>

				<div class="method-heading">
				
					<span class="method-name">annotations_with_attributes</span><span
						class="method-args">(attribs)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Same as the {obj}.<a
href="InstanceMethods.html#M000015">annotations_with_attribute</a> method
(above) but takes in an array for attribute names to look for.
</p>
<p>
NOTE (1): the argument to this method MUST be an Array of Strings.
</p>
					

					
					<div class="method-source-code"
						id="annotations-with-attributes-source">
<pre>
     <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 109</span>
109:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">annotations_with_attributes</span>(<span class="ruby-identifier">attribs</span>)
110:           <span class="ruby-keyword kw">return</span> [] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attribs</span>.<span class="ruby-identifier">blank?</span>
111:           
112:           <span class="ruby-identifier">obj_type</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:class_name_of_active_record_descendant</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>).<span class="ruby-identifier">to_s</span>
113:           
114:           <span class="ruby-constant">Annotation</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,
115:                           <span class="ruby-identifier">:joins</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:attribute</span>,
116:                           <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:annotatable_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">obj_type</span>,
117:                                            <span class="ruby-identifier">:annotatable_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span>,
118:                                            <span class="ruby-identifier">:annotation_attributes</span> =<span class="ruby-operator">&gt;</span>  { <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attribs</span> } },
119:                           <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;created_at DESC&quot;</span>)
120:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="count-annotations-by-method" class="method-detail ">
				<a name="M000020"></a>

				<div class="method-heading">
				
					<span class="method-name">count_annotations_by</span><span
						class="method-args">(source_type_in)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns the number of annotations on this annotatable object by the source
type specified. &#8220;all&#8221; (case insensitive) can be provided to get
all annotations regardless of source type. E.g.:
book.count_annotations_by(&#8220;User&#8221;) or
book.count_annotations_by(&#8220;All&#8221;)
</p>
					

					
					<div class="method-source-code"
						id="count-annotations-by-source">
<pre>
     <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 163</span>
163:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">count_annotations_by</span>(<span class="ruby-identifier">source_type_in</span>)
164:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">source_type_in</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">source_type_in</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;all&quot;</span>
165:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">annotations</span>.<span class="ruby-identifier">count</span>
166:           <span class="ruby-keyword kw">else</span>
167:             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">annotations</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:source_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source_type_in</span> })  
168:           <span class="ruby-keyword kw">end</span>
169:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="create-annotations-method" class="method-detail ">
				<a name="M000021"></a>

				<div class="method-heading">
				
					<span class="method-name">create_annotations</span><span
						class="method-args">(annotations_data, source)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Use this method to create many annotations from a Hash of data. Arrays for
Hash values will be converted to multiple annotations. Blank values (nil or
empty string) will be ignored and thus annotations will not be created for
them.
</p>
<p>
Returns an array of <a href="../../../Annotation.html">Annotation</a>
objects of the annotations that were successfully created.
</p>
<p>
Code example:
</p>
<hr size="10"></hr><p>
data = { &#8220;tag&#8221; => [ &#8220;tag1&#8221;, &#8220;tag2&#8221;,
&#8220;tag3&#8221; ], &#8220;description&#8221; => &#8220;This is a
book&#8221; } book.create_annotations(data, current_user)
</p>
					

					
					<div class="method-source-code"
						id="create-annotations-source">
<pre>
     <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 183</span>
183:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_annotations</span>(<span class="ruby-identifier">annotations_data</span>, <span class="ruby-identifier">source</span>)
184:           <span class="ruby-identifier">anns</span> = [ ]
185:           
186:           <span class="ruby-identifier">annotations_data</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attrib</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
187:             <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">blank?</span>
188:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Array</span>
189:                 <span class="ruby-identifier">val</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val_inner</span><span class="ruby-operator">|</span>
190:                   <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">val_inner</span>.<span class="ruby-identifier">blank?</span>
191:                     <span class="ruby-identifier">ann</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">annotations</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Annotation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:attribute_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attrib</span>, 
192:                                                  <span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">val_inner</span>, 
193:                                                  <span class="ruby-identifier">:source_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>, 
194:                                                  <span class="ruby-identifier">:source_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">id</span>)
195:                     
196:                     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ann</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">ann</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
197:                       <span class="ruby-identifier">anns</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ann</span>
198:                     <span class="ruby-keyword kw">end</span>
199:                   <span class="ruby-keyword kw">end</span>
200:                 <span class="ruby-keyword kw">end</span>
201:               <span class="ruby-keyword kw">else</span>
202:                 <span class="ruby-identifier">ann</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">annotations</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Annotation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:attribute_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attrib</span>, 
203:                                              <span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">val</span>, 
204:                                              <span class="ruby-identifier">:source_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span>, 
205:                                              <span class="ruby-identifier">:source_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">id</span>)
206:                 
207:                 <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ann</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">ann</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
208:                   <span class="ruby-identifier">anns</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ann</span>
209:                 <span class="ruby-keyword kw">end</span>
210:               <span class="ruby-keyword kw">end</span>
211:             <span class="ruby-keyword kw">end</span>
212:           <span class="ruby-keyword kw">end</span>
213:           
214:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">anns</span>
215:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
			<div id="latest-annotations-method" class="method-detail ">
				<a name="M000014"></a>

				<div class="method-heading">
				
					<span class="method-name">latest_annotations</span><span
						class="method-args">(limit=nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Helper method to get latest annotations
</p>
					

					
					<div class="method-source-code"
						id="latest-annotations-source">
<pre>
    <span class="ruby-comment cmt"># File lib/annotations/acts_as_annotatable.rb, line 79</span>
79:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">latest_annotations</span>(<span class="ruby-identifier">limit</span>=<span class="ruby-keyword kw">nil</span>)
80:           <span class="ruby-identifier">obj_type</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:class_name_of_active_record_descendant</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>).<span class="ruby-identifier">to_s</span>
81:           
82:           <span class="ruby-constant">Annotation</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,
83:                           <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">:annotatable_type</span> =<span class="ruby-operator">&gt;</span>  <span class="ruby-identifier">obj_type</span>, 
84:                                            <span class="ruby-identifier">:annotatable_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span> },
85:                           <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;created_at DESC&quot;</span>,
86:                           <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">limit</span>)
87:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

