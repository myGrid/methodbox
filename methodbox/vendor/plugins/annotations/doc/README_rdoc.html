<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>File: README.rdoc [Annotations Plugin]</title>

	<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>
</head>

<body class="file">
	<div id="metadata">
		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="./AUTHORS_rdoc.html">AUTHORS.rdoc</a></li>
				
					<li class="file"><a href="./CHANGELOG_rdoc.html">CHANGELOG.rdoc</a></li>
				
					<li class="file"><a href="./INDEX_rdoc.html">INDEX.rdoc</a></li>
				
					<li class="file"><a href="./LICENSE.html">LICENSE</a></li>
				
					<li class="file"><a href="./README_rdoc.html">README.rdoc</a></li>
				
					<li class="file"><a href="./RUNNING_TESTS_rdoc.html">RUNNING_TESTS.rdoc</a></li>
				
					<li class="file"><a href="./RakeFile.html">RakeFile</a></li>
				
					<li class="file"><a href="./TODO_rdoc.html">TODO.rdoc</a></li>
				
					<li class="file"><a href="./VERSION_yml.html">VERSION.yml</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./Annotations/Acts/Annotatable/ClassMethods.html">Annotations::Acts::Annotatable::ClassMethods</a></li>
				
					<li><a href="./Annotations/Acts/Annotatable/InstanceMethods.html">Annotations::Acts::Annotatable::InstanceMethods</a></li>
				
					<li><a href="./Annotations/Acts/Annotatable/SingletonMethods.html">Annotations::Acts::Annotatable::SingletonMethods</a></li>
				
					<li><a href="./Annotations/Acts/AnnotationSource/ClassMethods.html">Annotations::Acts::AnnotationSource::ClassMethods</a></li>
				
					<li><a href="./Annotations/Acts/AnnotationSource/InstanceMethods.html">Annotations::Acts::AnnotationSource::InstanceMethods</a></li>
				
					<li><a href="./Annotations/Acts/AnnotationSource/SingletonMethods.html">Annotations::Acts::AnnotationSource::SingletonMethods</a></li>
				
					<li><a href="./Annotations/Config.html">Annotations::Config</a></li>
				
					<li><a href="./AnnotationsVersionFu.html">AnnotationsVersionFu</a></li>
				
					<li><a href="./AnnotationsVersionFu/ClassMethods.html">AnnotationsVersionFu::ClassMethods</a></li>
				
					<li><a href="./AnnotationsVersionFu/InstanceMethods.html">AnnotationsVersionFu::InstanceMethods</a></li>
				
					<li><a href="./Annotation.html">Annotation</a></li>
				
					<li><a href="./AnnotationAttribute.html">AnnotationAttribute</a></li>
				
					<li><a href="./AnnotationValueSeed.html">AnnotationValueSeed</a></li>
				
					<li><a href="./AnnotationsController.html">AnnotationsController</a></li>
				
					<li><a href="./AnnotationsMigrationGenerator.html">AnnotationsMigrationGenerator</a></li>
				
					<li><a href="./AnnotationsMigrationV1.html">AnnotationsMigrationV1</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1>Annotations Plugin (for Ruby on Rails applications)</h1>
<table>
<tr><td valign="top">Original Author:</td><td>Jiten Bhagat (<a href="mailto:mail@jits.co.uk">mail@jits.co.uk</a>)

</td></tr>
<tr><td valign="top">Copyright:</td><td>&#169; 2008-2009, the University of Manchester and the European
Bioinformatics Institute (EMBL-EBI)

</td></tr>
<tr><td valign="top">License:</td><td>BSD

</td></tr>
<tr><td valign="top">Version:</td><td>0.1.0

</td></tr>
</table>
<h2>Overview</h2>
<p>
This plugin allows arbitrary metadata to be stored and retrieved for any
model object in your Ruby on Rails (v2.2+) application. This metadata is in
the form of attribute/value data pairs that, together with provenance
information, make up &#8216;annotations&#8217;. These annotations are
&#8220;attached&#8221; to a model object in your application.
</p>
<p>
The idea is to abstract out and decouple annotations from your
application&#8217;s core data model and allow layering in of metadata
easily.
</p>
<p>
Examples of things you can use the annotations plugin for:
</p>
<ul>
<li>Tags

</li>
<li>Categories

</li>
<li>Descriptions

</li>
<li>Examples

</li>
<li>Notes

</li>
<li>Comments

</li>
</ul>
<p>
The main benefit is that annotations are stored and retrieved in a uniform
manner with a common API. Parts of the plugin can also be extended and
overridden in your application (see the Usage section for more info).
</p>
<p>
The annotations plugin is currently being used successfully in the
BioCatalogue <a
href="http://rubyforge.org/projects/biocatalogue">codebase</a> to allow
easy annotation of web services and their
deployments/versions/operations/inputs/outputs/etc. Check out <a
href="http://www.biocatalogue.org.">www.biocatalogue.org.</a>
</p>
<h3>Features:</h3>
<ul>
<li>A complete set of ActiveRecord models for annotations, annotations
attributes and annotation value seeds.

</li>
<li>acts_as_annotatable and acts_as_annotation source mixin modules for your
models, complete with a number of advanced finders.

</li>
<li>A basic CRUD controller that can be used out of the box to list, create,
view, edit and delete annotations.

</li>
<li>Versioning of annotations - all updates to annotations cause a new version
of that annotation to be created.

</li>
<li><a href="Annotation.html">Annotation</a> Value Seeds can be used to set up
some default/preliminary seed data for attributes without having to create
annotations.

</li>
</ul>
<h2>Full Documentation</h2>
<p>
To generate full documentation (including this readme and full API docs) do
the following:
</p>
<p>
Install RDoc (v2.3.0 or above):
</p>
<pre>
  % [sudo] gem install rdoc
</pre>
<p>
Install the darkfish-rdoc gem:
</p>
<pre>
  % [sudo] gem install darkfish-rdoc
</pre>
<p>
Run the following command in the plugin&#8217;s root directory
(<em>vendor/plugins/annotations</em>):
</p>
<pre>
  % rdoc -SHNU -w 2 --title='Annotations Plugin' -m 'INDEX.rdoc' -x '(/doc|/tasks|/script|/test)'
</pre>
<p>
The generated documentation will be in the <em>doc</em> folder of the
annotations plugin.
</p>
<h2>Conceptual Data Model</h2>
<p>
At a conceptual level, an <b>Annotation</b> consists of:
</p>
<ul>
<li>a link to the thing being annotated - the <b>Annotatable</b>

</li>
<li>a link to the source of the annotation - the <b>Source</b>

</li>
<li>a link to the attribute which specifies what kind of annotation this is -
the <b>Attribute</b>

</li>
<li>the value of the annotation (currently only free text and stored as a
string) - the <b>Value</b>

</li>
<li>the data type of the value (defaults to &#8220;String&#8221;) - the
<b>Value Type</b>

</li>
<li>version information - <b>Version Info</b>

</li>
<li>timestamps for event time info - <b>Timestamps</b>

</li>
</ul>
<p>
This can be represented as:
</p>
<pre>
  Annotation = Annotatable + Source + Attribute + Value + Value Type + Version Info + Timestamps
</pre>
<p>
The database model for an <a href="Annotation.html">Annotation</a> is made
up of the following fields:
</p>
<pre>
  | id | annotatable_type | annotatable_id | source_type | source_id | attribute_id | value | value_type | version | version_creator_id | created_at | updated_at |
</pre>
<p>
This makes use of ActiveRecord polymorphic relationships to allow any
ActiveRecord model to be an Annotatable or Source.
</p>
<p>
<b>Note:</b> The <em>version_creator_id</em> field is only relevant when
there are more than one version of an <a
href="Annotation.html">Annotation</a>. I.e.: for the first version of the
annotation the <em>version_creator_id</em> will be nil.
</p>
<p>
<a href="Annotation.html">Annotation</a> Attributes currently only consist
of a name. This is the <em>attribute</em> or <em>property</em> you are
describing for an Annotatable. Examples: &#8216;tag&#8217;,
&#8216;description&#8217;, etc.
</p>
<h2>Versioning of Annotations</h2>
<p>
Whenever an <a href="Annotation.html">Annotation</a> is updated, a new
AnnotationVersion entry is created in the db (corresponding model name =
Annotation::Version).
</p>
<p>
This uses a library from the <a
href="http://github.com/jmckible/version_fu/tree/master">version_fu
plugin</a>. A customised version of this is embedded within the Annotations
plugin (which won&#8217;t conflict if version_fu is installed in the main
codebase).
</p>
<h2>Installation and Setup</h2>
<h3>Important Requirements</h3>
<ul>
<li>Only works for Ruby on Rails v2.2 and above.

</li>
<li>Your Application Controller MUST define (or have access to) the following
methods:

<ul>
<li><em>login_required</em> - a method that checks if the user is logged in and
if not redirects to the login page.

</li>
<li><em>logged_in?</em> - a method to check if the user is logged_in.

</li>
<li><em>current_user</em> - a method to retrieve the currently logged in user.
This MUST return nil if no user is currently logged in.

</li>
</ul>
</li>
</ul>
<h3>Installation</h3>
<p>
To install the plugin as a git cloned repo (this allows you to easily
update the plugin in the future):
</p>
<pre>
  ruby script/plugin install git://github.com/jits/annotations.git
</pre>
<p>
<b>Note:</b> this requires git to be installed.
</p>
<p>
To install the plugin the regular way:
</p>
<pre>
  ruby script/plugin install http://github.com/jits/annotations.git/
</pre>
<h3>Setup</h3>
<ul>
<li>Generate the migration(s):

<pre>
  ruby script/generate annotations_migration all
</pre>
</li>
<li>Create a config file - <em>config/initializers/annotations.rb</em> - for
the plugin specific configuration (see Usage section for the available
config options)

</li>
<li>Modify your application to work with the plugin:

<ul>
<li>Add the following line to the top of your
<em>app/controllers/application_controller.rb</em> file (or
<em>application.rb</em> in older versions of Rails):

<pre>
  require_dependency File.join(Rails.root, 'vendor', 'plugins', 'annotations', 'lib', 'app', 'controllers', 'application_controller')
</pre>
</li>
<li>Add the following line to the top of your
<em>app/helpers/application_helper.rb</em> file:

<pre>
  require_dependency File.join(Rails.root, 'vendor', 'plugins', 'annotations', 'lib', 'app', 'helpers', 'application_helper')
</pre>
</li>
</ul>
<p>
<b>Note:</b> the <em>require_dependency</em> line is crucial in making your
app work with the files in the plugin and allows for easy extension and
overriding of the plugin parts. *However, this does mean that any file with
the <em>require_dependency</em> line will not be automagically loaded by
Rails in development mode when changes have been made - a server restart is
required whenever any changes are made to these files.*
</p>
</li>
<li>Create the following files in your application:

<ul>
<li>Annotation model:

<pre>
  # app/models/annotation.rb
  #
  # This extends the Annotation model defined in the Annotations plugin.

  require_dependency File.join(Rails.root, 'vendor', 'plugins', 'annotations', 'lib', 'app', 'models', 'annotation')

  class Annotation &lt; ActiveRecord::Base
  end
</pre>
</li>
<li>AnnotationAttribute model:

<pre>
  # app/models/annotation_attribute.rb
  #
  # This extends the AnnotationAttribute model defined in the Annotations plugin.

  require_dependency File.join(Rails.root, 'vendor', 'plugins', 'annotations', 'lib', 'app', 'models', 'annotation_attribute')

  class AnnotationAttribute &lt; ActiveRecord::Base
  end
</pre>
</li>
<li>AnnotationsController controller:

<pre>
  # app/controllers/annotations_controller.rb
  #
  # This extends the AnnotationsController controller defined in the Annotations plugin.

  require_dependency File.join(Rails.root, 'vendor', 'plugins', 'annotations', 'lib', 'app', 'controllers', 'annotations_controller')

  class AnnotationsController &lt; ApplicationController
  end
</pre>
</li>
</ul>
<p>
These are used to extend/override the models and controller from the plugin
with extra actions, filters, validations, processing and so on (see Usage
section for more details and examples).
</p>
</li>
<li>Specify which models in your codebase can be <b>annotated</b> by adding
<em>acts_as_annotatable</em> in the model&#8217;s definition. For example:

<pre>
  class Service &lt; ActiveRecord::Base
    ...
    acts_as_annotatable
    ...
  end
</pre>
</li>
<li>Specify which models in your codebase can be the <b>source</b> of
annotations by adding <em>acts_as_annotation_source</em> in the
model&#8217;s definition. For example:

<pre>
  class User &lt; ActiveRecord::Base
    ...
    acts_as_annotation_source
    ...
  end
</pre>
</li>
</ul>
<p>
The Annotations plugin has now been installed and is ready for use. See the
Usage section for further details.
</p>
<h2>Usage</h2>
<h3>Quick Use</h3>
<ul>
<li>To add a bunch of Annotations to a model instance:

<pre>
  book = Book.find(1)
  data = {
    :description =&gt; &quot;My bookie wookie&quot;,
    :rating =&gt; 5,
    :tag =&gt; [ &quot;horror&quot;, &quot;romance&quot;, &quot;indiluted&quot;, &quot;true story&quot; ] }
  new_annotations = book.create_annotations(data, current_user)
</pre>
</li>
<li>Create an <a href="Annotation.html">Annotation</a> directly:

<pre>
  book = Book.find(10)
  ann1 = Annotation.new(:attribute_name =&gt; &quot;tag&quot;,
                        :value =&gt; &quot;hot&quot;,
                        :source_type =&gt; &quot;User&quot;,
                        :source_id =&gt; 100,
                        :annotatable_type =&gt; book.class.name,
                        :annotatable_id =&gt; book.id)
</pre>
</li>
<li>Building a simple form for adding a single <a
href="Annotation.html">Annotation</a>, like &#8216;description&#8217;, to a
specified model object:

<pre>
  &lt;% form_tag annotations_url do %&gt;
    &lt;%= hidden_field_tag &quot;annotation[annotatable_type]&quot;, &quot;Book&quot; -%&gt;
    &lt;%= hidden_field_tag &quot;annotation[annotatable_id]&quot;, 100 -%&gt;
    &lt;%= hidden_field_tag &quot;annotation[attribute_name]&quot;, &quot;description&quot; -%&gt;
    &lt;%= text_area_tag &quot;annotation[value]&quot; -%&gt;
    &lt;%= submit_tag &quot;Submit&quot;, :disable_with =&gt; &quot;Submitting...&quot; -%&gt;
  &lt;% end %&gt;
</pre>
</li>
<li>Building a simple form for adding multiple Annotations from one field, like
&#8216;tags&#8217;, to a specified model object:

<pre>
  &lt;% form_tag create_multiple_annotations_url do %&gt;
    &lt;%= hidden_field_tag &quot;separator&quot;, &quot;,&quot; -%&gt;
    &lt;%= hidden_field_tag &quot;annotation[annotatable_type]&quot;, &quot;Book&quot; -%&gt;
      &lt;%= hidden_field_tag &quot;annotation[annotatable_id]&quot;, 100 -%&gt;
    &lt;%= hidden_field_tag &quot;annotation[attribute_name]&quot;, &quot;description&quot; -%&gt;
    &lt;%= text_area_tag &quot;annotation[value]&quot; -%&gt;
    &lt;%= submit_tag &quot;Submit&quot;, :disable_with =&gt; &quot;Submitting...&quot; -%&gt;
  &lt;% end %&gt;
</pre>
</li>
<li>Find all Annotations for a model instance (that has
<em>acts_annotatable</em> specified in the model&#8217;s class):

<pre>
  book = Book.find(6806)
  annotations = book.annotations
</pre>
</li>
<li>Find all &#8216;tag&#8217; Annotations for a model instance (that has
<em>acts_annotatable</em> specified in the model&#8217;s class):

<pre>
  book = Book.find(23)
  tag_annotations = book.annotations_with_attribute(&quot;tag&quot;)
</pre>
</li>
<li>Find all Annotations for a model instance that have a number of different
attribute names (that has <em>acts_annotatable</em> specified in the
model&#8217;s class):

<pre>
  book = Book.find(22124)
  rating_annotations = book.annotations_with_attributes([ &quot;rating-performance&quot;, &quot;rating-usefulness&quot;, &quot;rating-documentation&quot; ])
</pre>
</li>
</ul>
<p>
See _More Examples_ below.
</p>
<h3>Important Usage Notes</h3>
<ul>
<li>When using the built in Annotations Controller to create annotations (as in
the forms examples above), the default is to use the <em>current_user</em>
as the Source. However, you can explicitly specify the source by adding
fields for &#8220;annotations[source_type]&#8221; and
&#8220;annotations[source_id]&#8221;.

</li>
<li>Attributes are NOT case-sensitive. So &#8216;description&#8217; and
&#8216;Description&#8217; will be the same <a
href="AnnotationAttribute.html">AnnotationAttribute</a> entity and
therefore all annotations with that attribute will be the exact same
type/class/kind of annotation).

</li>
<li>When displaying the values of annotations, ALWAYS clean the data using
methods like <em>h</em> (html escape), <em>sanitize</em> and
<em>white_list</em>.

</li>
<li>By default, duplicate annotations cannot be created (by
&#8220;duplicate&#8221; we mean: same value for the same attribute, on an
annotatable object, regardless of source). For example: a user cannot add a
description to a service that matches an existing description for that
service. You can override this behaviour for annotations with certain
attributes, using the configuration option:
<em>attribute_names_to_allow_duplicates</em>. NOTE: this is different to
the <em>limits_per_source</em> config_ option, which isn&#8217;t about
duplicate annotations, but rather limiting the quantity of annotations of a
specific attribute on a specific annotatable object by a specific source.

</li>
</ul>
<h3>Config Options</h3>
<p>
All the config options can be found in <em><a
href="lib/annotations/config_rb.html">lib/annotations/config.rb</a></em>,
listed below:
</p>
<ul>
<li><b>attribute_names_for_values_to_be_downcased</b>

</li>
<li><b>attribute_names_for_values_to_be_upcase</b>

</li>
<li><b>strip_text_rules</b>

</li>
<li><b>user_model_name</b>

</li>
<li><b>limits_per_source</b>

</li>
<li><b>attribute_names_to_allow_duplicates</b>

</li>
<li><b>value_restrictions</b>

</li>
</ul>
<p>
TODO: explain and document these.
</p>
<h3>More Examples</h3>
<ul>
<li>Create multiple &#8216;tag&#8217; Annotations from a single string value:

<pre>
  params = { :annotatable_type =&gt; &quot;Book&quot;,
             :annotatable_id =&gt; 78,
             :attribute_name =&gt; &quot;tag&quot;,
             :value =&gt; &quot;workflow, taverna, brilliant&quot;,
             :source_type =&gt; &quot;Group&quot;,
             :source_id =&gt; 4 }
  Annotation.create_multiple(params, ',')
</pre>
</li>
<li>Find all &#8216;comment&#8217; Annotations, by a specified Source, for a
model instance (that has <em>acts_annotatable</em> specified in the
model&#8217;s class):

<pre>
  book = Book.find(67)
  user = User.find_by_name(&quot;jane&quot;)
  annotations = book.annotations_with_attribute_and_by_source(&quot;comment&quot;, user)
</pre>
</li>
<li>Find all Annotations, that don&#8217;t have the specified attributes, for a
model instance (that has <em>acts_annotatable</em> specified in the
model&#8217;s class):

<pre>
  book = Book.find(56)
  annotations = book.all_annotations_excluding_attributes([ &quot;tag&quot;, &quot;note&quot;, &quot;example&quot; ])
</pre>
</li>
<li>Find Annotatable objects that have a specific attribute name AND value:

<ul>
<li>Gets all annotatables regardless of type:

<pre>
  Annotation.find_annotatables_with_attribute_name_and_value(&quot;complexity&quot;, &quot;O(x^2)&quot;)
</pre>
</li>
<li>Gets only annotatables that are Books:

<pre>
  Book.with_annotations_with_attribute_name_and_value(&quot;Tag&quot;, &quot;Amusing rhetoric&quot;)
</pre>
</li>
</ul>
</li>
<li>Find Annotatable objects that have a combination of attribute names AND
values:

<pre>
  Annotation.find_annotatables_with_attribute_names_and_values([ &quot;tag&quot; ], [ &quot;fiction&quot;, &quot;sci-fi&quot;, &quot;fantasy&quot; ])

  Annotation.find_annotatables_with_attribute_names_and_values([ &quot;tag&quot;, &quot;keyword&quot;, &quot;category&quot; ], [ &quot;fiction&quot;, &quot;fantasy&quot; ])
</pre>
</li>
<li>Count the number of Annotations, by any Source, for a model instance (that
has <em>acts_annotatable</em> specified in the model&#8217;s class):

<pre>
  book = Book.find(90)
  count = book.count_annotations_by(&quot;all&quot;)
</pre>
</li>
<li>Count the number of Annotations, by Users, for a model instance (that has
<em>acts_annotatable</em> specified in the model&#8217;s class):

<pre>
  book = Book.find(90)
  count = book.count_annotations_by(&quot;User&quot;)
</pre>
</li>
</ul>
<p>
TODO: add more advanced examples!
</p>
<h3>Extending the Plugin</h3>
<p>
Most of the aspects of this plugin can be extended/overridden in your
codebase.
</p>
<p>
Examples:
</p>
<ul>
<li>To restrict the values for certain annotations, you can either use the
Annotations::Config::value_restrictions setting and/or extend the <a
href="Annotation.html">Annotation</a> model in your own codebase and use
the ActiveRecord validates_inclusion_of validation. For the latter, an
example is below:

<pre>
  require_dependency RAILS_ROOT + '/vendor/plugins/annotations/lib/app/models/annotation'

  class Annotation &lt; ActiveRecord::Base
    ...

    validates_inclusion_of :value,
                           :in =&gt; [ &quot;fruit&quot;, &quot;nut&quot;, &quot;fibre&quot; ],
                           :message =&gt; &quot;Please select a valid category.&quot;,
                           :if =&gt; Proc.new { |ann| ann.attribute_name.downcase == &quot;category&quot; }

    ...
  end
</pre>
</li>
</ul>
<p>
TODO: add more!
</p>
<h4>See Also</h4>
<p>
The BioCatalogue <a
href="http://rubyforge.org/projects/biocatalogue">codebase</a> contains
many examples of using the Annotations plugin successfully. Some pointers:
</p>
<ul>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/config/initializers/biocat_main.rb">Configuring
the plugin</a> (scroll down to the &#8220;Configure the Annotations
plugin&#8221; section)

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/lib/bio_catalogue/annotations.rb">A
module to add extra logic on top of the Annotations plugin</a>

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/models/annotation.rb">The
extended \Annotation model</a>

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/models/annotation_attribute.rb">The
extended \AnnotationAttribute model</a>

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/controllers/annotations_controller.rb">The
extended \AnnotationsController controller</a>

</li>
<li>The AnnotationsHelper helper (to be added)

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/views/annotations/">Views
and partials for annotations</a>

</li>
<li>Tags (all of these build a layer on top of the annotations plugin,
specifically for tagging of objects):

<ul>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/lib/bio_catalogue/tags.rb">Module</a>

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/controllers/tags_controller.rb">Controller</a>
(adds new and alternative actions for tagging that builds on annotations).

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/helpers/tags_helper.rb">Views
Helper</a>

</li>
<li>Views:

<ul>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/views/annotations/_tags_box.html.erb">Tags
box</a>

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/views/annotations/_tags_flat.html.erb">Tags
flat</a>

</li>
</ul>
</li>
</ul>
</li>
<li>Ratings (all of these build a layer on top of the annotations plugin,
specifically for rating of objects):

<ul>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/controllers/ratings_controller.rb">Controller</a>
(adds new and alternative actions for rating that builds on annotations).

</li>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/helpers/ratings_helper.rb">Views
Helper</a>

</li>
<li>Views:

<ul>
<li><a
href="http://biocatalogue.rubyforge.org/svn/trunk/app/views/annotations/_ratings_box.html.erb">Ratings
box</a>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
The prototype <a
href="http://code.google.com/p/mygrid-shims-library/">Shims Library</a>
also makes use of the Annotations plugin successfully and may provide some
useful examples.
</p>
<h2>Updating the Plugin</h2>
<p>
Update the plugin code using the appropriate mechanism. Then:
</p>
<pre>
  ruby script/generate annotations_migration vX
</pre>
<p>
&#8230; where X is the version of the migration you want to generate
</p>
<h2>Main Plugin Contents</h2>
<p>
TODO: list files and what the purpose of each is.
</p>
<h2>Known Issues</h2>
<ul>
<li>May not work with sqlite and sqlite3 databases.

</li>
<li>Not tested with Postgres DB.

</li>
<li>Doesn&#8217;t work consistently well with Single Table Inheritance (STI).

</li>
</ul>
<h2>Troubleshooting</h2>
<ul>
<li>Whilst running in development mode, if you get an error such as:

<pre>
  A copy of ApplicationController has been removed from the module tree but is still active!
</pre>
<p>
&#8230; then restart your server. This is due to the way Rails autoloads
files in development mode, which affects the plugin and any extensions in
the main app.
</p>
</li>
</ul>
<h2>Future Plans</h2>
<p>
In no particular order:
</p>
<ul>
<li>Allow curation assertions such as &#8220;Agree&#8221;,
&#8220;Useful&#8221;, &#8220;Incomplete&#8221; to be made on annotations.

</li>
<li>Allow values to be any model rather than free text and provide a basic set
of annotation value models, such as AnnotationValueFreeText,
AnnotationValueNumber, AnnotationValueUri, etc

</li>
<li>Extend the <a href="AnnotationAttribute.html">AnnotationAttribute</a> model
to contain controlled vocabulary / ontology term information.

</li>
<li>Update the versioning to a better version of <em>version_fu</em>. See: <a
href="http://github.com/jmckible/version_fu/network">github.com/jmckible/version_fu/network</a>

</li>
</ul>
<h2>Appendix A: Data Model</h2>
<h3>Annotations</h3>
<p>
Table name: annotations
</p>
<p>
Fields:
</p>
<ul>
<li>id

</li>
<li>source_type

</li>
<li>source_id

</li>
<li>annotatable_type

</li>
<li>annotatable_id

</li>
<li>attribute_id

</li>
<li>value

</li>
<li>value_type

</li>
<li>created_at

</li>
<li>updated_at

</li>
<li>version

</li>
<li>version_creator_id

</li>
</ul>
<h3>Annotation Versions</h3>
<p>
Table name: annotation_versions
</p>
<p>
Fields:
</p>
<ul>
<li>id

</li>
<li>annotation_id

</li>
<li>version

</li>
<li>version_creator_id

</li>
<li>source_type

</li>
<li>source_id

</li>
<li>annotatable_type

</li>
<li>annotatable_id

</li>
<li>attribute_id

</li>
<li>value

</li>
<li>value_type

</li>
<li>created_at

</li>
<li>updated_at

</li>
</ul>
<h3>Annotation Attributes</h3>
<p>
Table name: annotation_attributes
</p>
<p>
Fields:
</p>
<ul>
<li>id

</li>
<li>name

</li>
<li>created_at

</li>
<li>updated_at

</li>
</ul>
<h3>Annotation Value Seeds</h3>
<p>
Table name: annotation_value_seeds
</p>
<p>
Fields:
</p>
<ul>
<li>id

</li>
<li>attribute_id

</li>
<li>value

</li>
<li>created_at

</li>
<li>updated_at

</li>
</ul>

	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>
</body>
</html>

